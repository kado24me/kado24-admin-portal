<th:block th:replace="~{layout :: content(~{::section})}">
  <section>
  <div class="d-flex justify-content-between align-items-center mb-3">
    <div class="h5 mb-0">
      <span th:if="${currentRole == 'MERCHANT'}">Merchant Users</span>
      <span th:unless="${currentRole == 'MERCHANT'}">Users Management</span>
    </div>
    <span class="badge bg-primary" th:text="${#lists.size(users)}">0</span>
  </div>
  
  <input class="form-control mb-3" placeholder="ðŸ” Search users..." id="searchInput" />
  
  <ul class="nav nav-pills mb-3">
    <li class="nav-item" th:unless="${currentRole != null}">
      <a class="nav-link" 
         th:classappend="${currentStatus == 'ALL' || currentStatus == null} ? 'active' : ''"
         th:href="@{/users}">All</a>
    </li>
    <li class="nav-item" th:unless="${currentRole != null}">
      <a class="nav-link" 
         th:classappend="${currentStatus == 'ACTIVE'} ? 'active' : ''"
         th:href="@{/users(status='ACTIVE')}">Active</a>
    </li>
    <li class="nav-item" th:unless="${currentRole != null}">
      <a class="nav-link" 
         th:classappend="${currentStatus == 'BLOCKED'} ? 'active' : ''"
         th:href="@{/users(status='BLOCKED')}">Blocked</a>
    </li>
    <li class="nav-item" th:if="${currentRole == 'MERCHANT'}">
      <a class="nav-link active">Merchants</a>
    </li>
  </ul>
  
  <div th:if="${currentRole == 'MERCHANT'}" class="alert alert-info mb-3">
    Showing all users with <strong>MERCHANT</strong> role.
  </div>
  
  <div th:if="${#lists.isEmpty(users)}" class="alert alert-info">
    <span th:if="${currentRole == 'MERCHANT'}">No merchant users found.</span>
    <span th:unless="${currentRole == 'MERCHANT'}">No <span th:text="${currentStatus ?: 'users'}"></span> found.</span>
  </div>
  
  <div th:each="user : ${users}" class="stat-card small mb-2 d-flex justify-content-between align-items-center">
    <div>
      <div class="fw-bold" th:text="${user.email ?: user.username}">user@email.com</div>
      <div class="text-muted">
        <span th:if="${user.fullName}"><span th:text="${user.fullName}"></span> â€¢ </span>
        <span th:if="${user.createdAt}">
          Joined: <span th:text="${#temporals.format(user.createdAt, 'MMM dd, yyyy')}"></span>
        </span>
      </div>
    </div>
    <div class="text-end">
      <span class="badge" 
            th:classappend="${user.status == 'ACTIVE'} ? 'bg-success' : 
                           (${user.status == 'BLOCKED'} ? 'bg-danger' : 'bg-secondary')"
            th:text="${user.status}">Active</span>
      <div class="text-muted small mt-1">
        <span th:if="${user.role}" class="badge bg-info text-dark" th:text="${user.role}">ROLE</span>
      </div>
      <div class="text-muted small mt-1" th:if="${user.voucherCount != null}">
        <span th:text="${user.voucherCount}"></span> vouchers
      </div>
    </div>
  </div>
  
  <div class="row g-3 mt-3">
    <div class="col-6">
      <div class="stat-card text-center">
        <div class="h4 mb-0" th:text="${statistics?.totalUsers ?: 0}">0</div>
        <div class="text-muted">Total Users</div>
      </div>
    </div>
    <div class="col-6">
      <div class="stat-card text-center">
        <div class="h4 mb-0 text-danger" th:text="${statistics?.blockedUsers ?: 0}">0</div>
        <div class="text-muted">Blocked</div>
      </div>
    </div>
  </div>
  
  <script>
    // Simple client-side search
    document.getElementById('searchInput')?.addEventListener('input', function(e) {
      const searchTerm = e.target.value.toLowerCase();
      const userCards = document.querySelectorAll('.stat-card.small');
      userCards.forEach(card => {
        const text = card.textContent.toLowerCase();
        card.style.display = text.includes(searchTerm) ? '' : 'none';
      });
    });
  </script>
  </section>
</th:block>


